(()=>{"use strict";var e={128:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},256:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"},528:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},808:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},404:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},100:e=>{e.exports="https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,o),c.exports}o.m=e,o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.b=document.baseURI||self.location.href;var n={};(()=>{o.d(n,{O:()=>z,k:()=>U}),new URL(o(128),o.b),new URL(o(528),o.b),new URL(o(808),o.b),new URL(o(404),o.b),new URL(o(100),o.b),new URL(o(256),o.b);var e=document.querySelector("#card-template").content,t=document.querySelector(".places__list"),r=document.querySelector(".profile__edit-button"),c=document.querySelector(".profile__add-button"),a=document.querySelector(".profile__image"),i=document.querySelectorAll(".popup"),u=document.querySelector(".popup_type_edit"),s=document.querySelector(".popup_type_new-card"),p=document.querySelector(".popup_type_edit_image_profile"),l=document.querySelector(".popup_type_image"),d=document.querySelector(".popup__image"),_=document.querySelector(".popup__caption"),f=document.forms[1].querySelector(".popup__input_type_card-name"),m=document.forms[1].querySelector(".popup__input_type_url"),y=document.querySelector(".popup__form"),v=y.querySelector(".popup__input_type_name"),h=y.querySelector(".popup__input_type_description"),g=document.querySelector(".profile__title"),b=document.querySelector(".profile__description"),S="https://nomoreparties.co/v1/wff-cohort-7",q="c304b8c8-5801-40ad-8a7c-7577a1a44342",L="application/json",k=function(){return fetch(S+"/cards",{method:"GET",headers:{authorization:q}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){for(var o=t.querySelectorAll(".card__count-like"),n=0;n<e.length;n++)o[n].textContent=e[n].likes.length;for(var r=t.querySelectorAll(".card__delete-button"),c=t.querySelectorAll(".card__like-button"),a=t.querySelectorAll(".card"),i=0;i<e.length;i++){a[i].setAttribute("id",e[i]._id),"9b82ff17313d5386beb2923b"===e[i].owner._id?r[i].style.visibility="visible":r[i].style.visibility="hidden";for(var u=0;u<e[i].likes.length;u++)"9b82ff17313d5386beb2923b"===e[i].likes[u]._id&&c[i].classList.add("card__like-button_is-active")}})).catch((function(e){console.log("Ошибка: ".concat(e))}))};function E(e){e.target.parentElement.remove(),fetch(S+"/cards/"+e.target.parentElement.id,{method:"DELETE",headers:{authorization:q}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){})).catch((function(e){console.log("Ошибка: ".concat(e))}))}function x(e){e.target.classList.contains("card__like-button_is-active")?(e.target.classList.toggle("card__like-button_is-active"),function(e){fetch(S+"/cards/likes/"+e.target.parentElement.parentElement.parentElement.id,{method:"DELETE",headers:{authorization:q}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))}))}(e)):(e.target.classList.add("card__like-button_is-active"),function(e){fetch(S+"/cards/likes/"+e.target.parentElement.parentElement.parentElement.id,{method:"PUT",headers:{authorization:q}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))}))}(e))}function j(t,o,n,r,c){var a=e.querySelector(".card").cloneNode(!0),i=a.querySelector(".card__image");return i.src=o,i.alt=t,a.querySelector(".card__title").textContent=t,a.querySelector(".card__delete-button").addEventListener("click",n),a.querySelector(".card__like-button").addEventListener("click",r),i.addEventListener("click",c),a}function C(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",U)}function w(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",U)}var A,P=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove("button_inactive"):t.classList.add("button_inactive")};(A=Array.from(document.querySelectorAll(".popup__form"))).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),A.forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(".popup__input")),o=e.querySelector(".popup__button");P(t,o),t.forEach((function(n){n.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),o.classList.remove("form__input-error_active"),o.textContent=""}(e,t):function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),n.textContent=o,n.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,n),P(t,o)}))}))}(e)}))}));var T=function(e,t){t.textContent=e?"Сохранить...":"Сохранить"};function z(e){d.src=e.target.src,d.alt=e.target.alt;var t=e.target.parentElement.querySelector(".card__title");_.textContent=t.textContent,C(l)}function O(e,t){var o=e.querySelectorAll(".form__input-error"),n=e.querySelectorAll(".popup__input");o.forEach((function(e){e.textContent="",e.classList.remove("form__input-error_active")})),n.forEach((function(e){e.classList.remove("form__input_type_error")}))}function U(e){var t=document.querySelector(".popup_is-opened");"Escape"===e.key&&(w(t),(t.classList.contains("popup_type_edit")||t.classList.contains("popup_type_new-card"))&&O(t))}fetch(S+"/cards",{method:"GET",headers:{authorization:q}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){e.forEach((function(e){t.append(j(e.name,e.link,E,x,z))})),k()})).catch((function(e){console.log("Ошибка: ".concat(e))})),i.forEach((function(e){e.classList.add("popup_is-animated")})),r.addEventListener("click",(function(){var e=u.querySelector(".popup__button");T(!1,e);var t=g.textContent,o=b.textContent;v.value=t,h.value=o,u.querySelector(".popup__button").classList.remove("button_inactive"),C(u)})),c.addEventListener("click",(function(){var e=s.querySelector(".popup__button");T(!1,e),C(s)})),a.addEventListener("click",(function(){var e=p.querySelector(".popup__button");T(!1,e),C(p)})),i.forEach((function(e){e.addEventListener("click",(function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&(w(e),(t.target.classList.contains("popup_type_edit")||t.target.classList.contains("popup_type_new-card"))&&O(t.target))}))})),y.addEventListener("submit",(function(e){e.preventDefault();var t=e.target.querySelector(".popup__button");T(!0,t),g.textContent=v.value,b.textContent=h.value,fetch(S+"/users/me",{method:"PATCH",headers:{authorization:q,"Content-Type":L},body:JSON.stringify({name:v.value,about:h.value})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){k()})).catch((function(e){console.log("Ошибка: ".concat(e))})),w(u)})),document.forms["new-place"].addEventListener("submit",(function(e){e.preventDefault();var o=e.target.querySelector(".popup__button");T(!0,o),t.prepend(j(f.value,m.value,E,x,z)),fetch(S+"/cards",{method:"POST",headers:{authorization:q,"Content-Type":L},body:JSON.stringify({name:f.value,link:m.value})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})),w(s),y.reset()})),document.forms["edit-image-profile"].addEventListener("submit",(function(e){e.preventDefault();var t=e.target.querySelector(".popup__button");T(!0,t);var o=e.target.querySelector(".popup__input_type_url_image");!function(e){var t=e.target.querySelector(".popup__input_type_url_image");fetch(S+"/users/me/avatar",{method:"PATCH",headers:{authorization:q,"Content-Type":L},body:JSON.stringify({avatar:t.value})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))}))}(e),document.querySelector(".profile__image").style.backgroundImage="url("+o.value+")",w(p)}))})()})();